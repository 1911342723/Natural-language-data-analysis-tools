# 🚀 快速开始指南

## 📋 前置要求

- Node.js >= 16.0.0
- npm >= 8.0.0（或 yarn、pnpm）
- 后端服务已启动（http://localhost:8000）

---

## ⚡ 5分钟快速启动

### 1️⃣ 安装依赖

```bash
cd frontend
npm install
```

如果速度慢，可以使用国内镜像：

```bash
npm install --registry=https://registry.npmmirror.com
```

### 2️⃣ 启动开发服务器

```bash
npm run dev
```

看到以下输出表示成功：

```
VITE v5.3.1  ready in 500 ms

➜  Local:   http://localhost:3000/
➜  Network: use --host to expose
➜  press h + enter to show help
```

### 3️⃣ 打开浏览器

访问 http://localhost:3000

你会看到一个漂亮的文件上传界面！🎉

---

## 📝 使用步骤

### 第一步：上传数据文件

1. 点击或拖拽 Excel/CSV 文件到上传区域
2. 支持的格式：
   - Excel: `.xlsx`, `.xls`
   - CSV: `.csv`
3. 文件大小限制：100MB

**示例数据：**

你可以创建一个简单的 CSV 测试：

```csv
姓名,年龄,城市,销售额
张三,28,北京,15000
李四,32,上海,22000
王五,25,广州,18000
赵六,35,深圳,28000
```

保存为 `test_data.csv` 并上传。

### 第二步：选择分析字段

上传成功后，左侧会出现字段选择侧边栏：

1. ✅ 勾选需要分析的字段（如：年龄、销售额）
2. 🔍 可以搜索字段
3. 👁️ 下方会显示已选字段的数据预览

**提示**：至少选择1个字段才能开始分析！

### 第三步：输入分析需求

在底部输入框中用自然语言描述需求：

```
计算销售额的平均值、最大值和最小值
```

或者点击示例需求快速填充：

- 💡 计算所选字段的基本统计信息
- 💡 按某个字段分组，统计每组的数量
- 💡 绘制数值字段的分布直方图

### 第四步：观察 Agent 执行过程 ⭐

点击 **发送** 后，你会看到：

1. **步骤流程图**
   ```
   生成代码 → 执行代码 → 判断结果 → [修复代码] → 成功
   ```

2. **每个步骤的详细信息**
   - 📝 AI 生成的 Python 代码（语法高亮）
   - 🖥️ 执行输出（控制台输出）
   - ❌ 错误信息（如果有）
   - 🔄 修复过程（自动重试）

### 第五步：查看分析结果

执行成功后，会展示三个标签页：

1. **📄 AI 总结**
   - 用自然语言总结分析结果
   - 提取关键信息和洞察

2. **📊 数据表格**
   - 展示统计结果
   - 支持排序、筛选
   - 可导出为 CSV

3. **📈 图表**
   - 可视化图表
   - 支持查看大图
   - 可下载为 PNG

---

## 🎬 完整使用示例

### 示例1：销售数据分析

**数据文件：** `sales.csv`

```csv
地区,产品,销售额,订单数
北京,手机,150000,120
上海,手机,180000,150
广州,电脑,220000,80
深圳,平板,130000,100
北京,电脑,200000,70
```

**操作步骤：**

1. 上传 `sales.csv`
2. 选择字段：地区、产品、销售额、订单数（全选）
3. 输入需求：
   ```
   按地区分组，计算每个地区的总销售额和平均订单数，并绘制柱状图
   ```
4. 观察 Agent 执行：
   ```
   Step 1: 生成代码
   ↓
   import pandas as pd
   import matplotlib.pyplot as plt
   
   result = df.groupby('地区').agg({
       '销售额': 'sum',
       '订单数': 'mean'
   })
   
   Step 2: 执行代码
   ↓
   ✅ 执行成功
   
   Step 3: 判断结果
   ↓
   ✅ 结果有效
   
   Step 4: 成功 ✅
   ```

5. 查看结果：
   - **表格**：各地区统计数据
   - **图表**：销售额柱状图
   - **总结**：
     ```
     根据分析结果：
     1. 广州地区总销售额最高，达到 220,000 元
     2. 上海地区平均订单数最多，为 150 单
     3. 四个地区的总销售额为 880,000 元
     ```

### 示例2：用户行为分析

**数据文件：** `user_behavior.csv`

```csv
用户ID,年龄,性别,访问次数,购买金额
1001,25,女,15,3500
1002,32,男,8,1200
1003,28,女,22,5600
1004,45,男,5,800
1005,35,女,18,4200
```

**操作步骤：**

1. 上传文件
2. 选择字段：年龄、性别、访问次数、购买金额
3. 输入需求：
   ```
   按性别分组，计算平均年龄、平均访问次数和平均购买金额，
   并分析哪个性别群体的购买力更强
   ```
4. 等待 Agent 执行
5. 查看 AI 总结和数据

---

## 🔧 常见问题

### Q1: 页面无法访问？

**检查清单：**
- ✅ 开发服务器是否启动？（`npm run dev`）
- ✅ 端口 3000 是否被占用？
- ✅ 浏览器控制台是否有错误？

**解决方法：**

修改端口：

```javascript
// vite.config.js
export default defineConfig({
  server: {
    port: 3001,  // 改为其他端口
  },
})
```

### Q2: 文件上传失败？

**可能原因：**
1. 后端服务未启动
2. 文件格式不支持
3. 文件过大（>100MB）

**解决方法：**

检查后端服务：

```bash
curl http://localhost:8000/api/health
```

如果返回 `{"status": "ok"}`，说明后端正常。

### Q3: Agent 一直在"执行中"状态？

**可能原因：**
1. 后端处理时间过长
2. 代码执行出错但未返回结果
3. 网络连接中断

**解决方法：**

1. 打开浏览器控制台，查看 Network 面板
2. 检查 `/api/agent/status/:taskId` 请求是否正常
3. 查看后端日志

### Q4: 代码生成不符合预期？

**优化提示词：**

❌ 不好的描述：
```
分析数据
```

✅ 好的描述：
```
对"销售额"字段进行统计分析，计算总和、平均值、最大值、最小值，
并按"地区"字段分组展示各地区的销售情况
```

**技巧：**
- 明确指定字段名（用引号标注）
- 说明具体的分析目标
- 描述期望的输出格式

### Q5: 如何查看执行的代码？

在 **Agent 执行过程** 区域，点击展开任意步骤，即可看到：

1. 📝 生成的完整 Python 代码
2. 🖥️ 代码执行输出
3. ❌ 错误信息（如果有）

你还可以：
- 📋 复制代码（点击"复制"按钮）
- 💾 保存到本地（Ctrl+C 复制）

---

## 🎨 界面功能说明

### 顶部导航栏

```
┌──────────────────────────────────────────────┐
│ 📄 智能数据分析工具          🕒 历史记录    │
└──────────────────────────────────────────────┘
```

- **标题**：显示应用名称
- **历史记录按钮**：查看之前的分析记录

### 左侧字段选择栏（可折叠）

```
┌─────────────────┐
│ ✅ 选择分析字段  │
├─────────────────┤
│ 🔍 [搜索框]     │
│                 │
│ ☑️ 姓名 [string]│
│ ☑️ 年龄 [int]   │
│ ☐ 城市 [string] │
│ ☑️ 销售额 [float]│
│                 │
│ [已选字段预览]   │
└─────────────────┘
```

- **搜索框**：快速查找字段
- **字段列表**：勾选需要的字段
- **类型标签**：显示字段数据类型
- **数据预览**：显示已选字段的前5行数据

### 主工作区

```
┌────────────────────────────────────┐
│ 📊 数据预览（可收起）              │
├────────────────────────────────────┤
│ 💬 对话历史                        │
│                                    │
│ [你]: 计算销售额平均值              │
│ [AI]: ✅ 分析完成！                │
│                                    │
├────────────────────────────────────┤
│ 🤖 Agent 执行过程                   │
│ Step 1 → Step 2 → Step 3 → ✅      │
├────────────────────────────────────┤
│ 💡 试试这些：                      │
│ [计算统计信息] [分组统计] [绘图]   │
│                                    │
│ ┌──────────────────────────────┐  │
│ │ [输入框]                      │  │
│ │ 描述你的分析需求...            │  │
│ └──────────────────────────────┘  │
│                         [发送]     │
└────────────────────────────────────┘
```

---

## 🚦 开发命令

```bash
# 安装依赖
npm install

# 启动开发服务器（热更新）
npm run dev

# 构建生产版本
npm run build

# 预览生产构建
npm run preview

# 代码检查
npm run lint

# 代码格式化（如果配置了 prettier）
npm run format
```

---

## 📦 生产部署

### 构建

```bash
npm run build
```

构建产物在 `dist/` 目录。

### 部署到 Nginx

```nginx
server {
    listen 80;
    server_name yourdomain.com;

    root /path/to/frontend/dist;
    index index.html;

    # SPA 路由支持
    location / {
        try_files $uri $uri/ /index.html;
    }

    # API 代理
    location /api {
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
```

### 使用 Docker

创建 `Dockerfile`：

```dockerfile
FROM node:18-alpine as builder

WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
```

构建并运行：

```bash
docker build -t data-analysis-frontend .
docker run -p 80:80 data-analysis-frontend
```

---

## 📞 获取帮助

- 📖 查看完整文档：`README.md`
- 🏗️ 了解架构设计：`ARCHITECTURE.md`
- 🐛 遇到问题？查看浏览器控制台错误信息
- 💬 查看后端日志：`backend/logs/`

---

## 🎉 开始你的第一次分析！

现在你已经准备好了！上传一个数据文件，选择字段，输入你的分析需求，看看 AI Agent 如何帮你自动完成数据分析吧！

**祝使用愉快！** 🚀


